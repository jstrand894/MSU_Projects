<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Ecology of Brome and Parasitoids - 2&nbsp; Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./1c_methods.html" rel="next">
<link href="./index.html" rel="prev">
<link href="./img/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #0e1d4e;
      }
</style>


<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="_box.scss">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1b_introduction.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Ecology of Brome and Parasitoids</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jstrand894/MSU_paper1" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Ecology-of-Brome-and-Parasitoids.docx">
              <i class="bi bi-bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Ecology-of-Brome-and-Parasitoids.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Title Page</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1b_introduction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1c_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Materials and Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1d_results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1e_discussion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discussion</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Figures</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Ecologists and farmers frequently hold divergent views regarding the importance of natural habitats within agricultural landscapes, a distinction often overlooked in ecological and conservation discourse <span class="citation" data-cites="Tscharntke2016">(Tscharntke et al. 2016)</span>. While ecologists recognize the role of natural habitats such as field border vegetation in supporting biodiversity and providing potential ecosystem services like biological pest control, many farmers perceive these semi-arid habitat remnants as occupying valuable cropland or even as sources of pests. As such, documenting how pest and natural enemy populations interact with agricultural landscapes alongside semi-natural habitat buffers on the crop periphery is important in determining the degree of the services or disservices provided.</p>
<p>Numerous polyphagous insect herbivores and their natural enemies rely on a variety of resources found across diverse habitat types within their environment. Depending upon the quality of the resource, different habitat types can serve as sources for increased pest or natural enemy populations. Similarly, these habitat types can serve as sinks that decrease populations <span class="citation" data-cites="Kennedy2000">(Kennedy and Storer 2000)</span>. Altering the presence of these resources can have impacts on pest or natural enemy populations and can alter the ecology between the examined species. For example, diversifying the edge cropping of organic <em>Brassica</em> using fava beans, fennel, and marigolds results in a diversity in beneficial arthropod communities that help reduce phytophagous herbivory <span class="citation" data-cites="DeMorais2023">(Morais et al. 2023)</span>.</p>
<p>Understanding the ways in which landscape habitat diversity impacts the ecological relationship between pest and enemy is crucial for effectively managing pest species in large scale cropping systems. Similarly, understanding how herbivore plant-hosts act as reservoirs for pests or beneficial natural enemies can potentially play a role in stabilizing year-over-year agricultural impact from these pests <span class="citation" data-cites="Cano2022">(Cano et al. 2022)</span>.</p>
<p>The wheat stem sawfly (WSS), Hymenoptera <em>Cephus cinctus</em> Norton, is a grass-mining sawfly native to North America [<span class="citation" data-cites="Criddle1922">Criddle (1922)</span>; Ainslie1929; <span class="citation" data-cites="Wallace1966">Wallace and McNeal (1966)</span>; <span class="citation" data-cites="Lesieur2016">Lesieur et al. (2016)</span>]. Originally adept at utilizing wild grass hosts, the species became a major pest to cultivated cereals as this resource became more prevalent following European settlement, becoming a notable pest of winter wheat in 1990 in Montana <span class="citation" data-cites="Morrill1996">(Morrill and Kushnak 1996)</span>, and more recently in Colorado <span class="citation" data-cites="Cockrell2021">(Cockrell et al. 2021)</span>. Climate warming has the potential to further expand the range of this pest both northward and southward <span class="citation" data-cites="Olfert2019 Weaver2023">(Olfert et al. 2019, Weaver 2023)</span>. Adult female WSS use their saw-like ovipositor to lay their eggs in the lumen of stems, where the eggs hatch, leading to larval feeding of parenchyma tissue [Roemhild1954; <span class="citation" data-cites="Holmes1956">Holmes and Farstad (1956)</span>]. Economic damage manifests in the form of both kernel weight reduction caused by tissue damage [<span class="citation" data-cites="Beres2011a">Beres et al. (2011)</span>; Delaney2010] and stem toppling due to late-season larval girdling <span class="citation" data-cites="Holmes1960 Nansen2005a McCullough2020">(Holmes and Peterson 1960, Nansen et al. 2005, McCullough et al. 2020)</span>.</p>
<p>Several parasitoid or predatory species attack <em>C. cinctus</em> within wild grass hosts <span class="citation" data-cites="Davis1955 Morrill1998">Morrill et al. (2001)</span>, however, two species, <em>Bracon cephis</em> (Gahan) and <em>Bracon lissogaster</em> Muesebeck (Hymenoptera: Braconidae), have been observed targeting WSS within cultivated cereals <span class="citation" data-cites="Nelson1953 Morrill1998 Runyon2001a Runyon2001b">(Nelson and Farstad 1953, Morrill et al. 1998, Runyon et al. 2001, Runyon 2001)</span>. These two host-specific ectoparasitoids are native to North America. Both parasitoids are bivoltine, with the first generation present in Montana from late-June to late-July, while the second generation is active from mid-July to September <span class="citation" data-cites="Gahan1918 Somsen1956 Davis2013">(Gahan 1918, Somsen and Luginbill 1956, Davis 2013)</span>. Adult female <em>B. cephi</em> and <em>B. lissogaster</em> inject a paralytic toxin into a <em>C. cinctus</em> larvae within the host stem, paralyzing the host larvae, and depositing from a single (<em>B. cephi</em>) to 1-3 (<em>B. lissogaster</em>) eggs. <em>B. cephi</em> and <em>B. lissogaster</em> have been shown to provide biological control via irreplaceable mortality of <em>C. cinctus</em> populations <span class="citation" data-cites="Buteler2015 Peterson2011">(Peterson et al. 2011, Buteler et al. 2015)</span> and can significantly reduce <em>C. cinctus</em> damage and impact on crop yields <span class="citation" data-cites="Buteler2008 Adhikari2019 Bekkerman2018 Rand2020">(Buteler et al. 2008, Bekkerman and Weaver 2018, Adhikari et al. 2019, Rand et al. 2020)</span>. While <em>C. cinctus</em> has a wide range of viable host plants, including native and non-native grasses and cultivated row-crops such as wheat (<em>Triticum aestivum L.</em>) and barley (<em>Hordeum vulgare</em>) <span class="citation" data-cites="Wallace1966 Cockrell2017 Achhami2020">(Wallace and McNeal 1966, Cockrell et al. 2017, Achhami et al. 2020)</span>, infestation levels can vary widely across hosts. Previous research has shown preference for host plants with larger stem diameter <span class="citation" data-cites="Ainslie1920 Buteler2009 Bhandari2020">(Ainslie 1920, Buteler et al. 2009, Bhandari 2020)</span>.</p>
<p>Recent research has shown natural non-cultivated grasses such as <em>Agropyron cristatum</em>, <em>Bromus techtorum</em>, <em>Bromus inermis</em>, <em>Elymus trachycaulus</em>, and <em>Thinopyrum intermedium</em> host <em>C. cinctus</em> and most also host Bracon spp. parasitoids quite well <span class="citation" data-cites="Mendoza2006 Peirce2021 Rand2024">(Perez-Mendoza and Weaver 2006, Peirce et al. 2021, Rand et al. 2024)</span>. We find investigating <em>B. inermis</em> holds the most potential, as it has been shown to be a quality initially-accepted host for <em>C. cinctus</em> oviposition while also leading to high larval mortality later on <span class="citation" data-cites="Seamans1928 Farstad1945">(Seamans 1928, Farstad and Jacobson 1945)</span>. However, there is a lack of detailed relating to the total infestation, cutting, and parasitism within <em>B. inermis</em> at multiple time points throughout the growing season. Quantitative assessment of potential ‘reservoir’ characteristics and local spatial information could prove useful in fully understanding the ecological impacts of maintaining <em>B. inermis</em> along roadways and within coulees.</p>
<p>Smooth brome (<em>Bromus inermis</em> Leyss) is a Eurasian cool-season rhizomatous grass introduced to the United States in 1884 <span class="citation" data-cites="Bolwahn2011">(Salesman and Thomsen 2011)</span>.<em>B. inermis</em> was originally thought of as potentially useful as a trap crop in order to combat the growing WSS problem with cultural control practices <span class="citation" data-cites="Criddle1922 Seamans1928 Farstad1945 Beres2011a">(Criddle 1922, Seamans 1928, Farstad and Jacobson 1945, Beres et al. 2011)</span>. Due to its low agricultural value, and propensity to form monocultures and out compete many native grasses, <em>B. inermis</em> is categorized as invasive in some habitats <span class="citation" data-cites="Carlson1985 Willson2000 Dillemuth2008">(Carlson and Newell 1985, Willson and Stubbendieck 2000, Dillemuth et al. 2008)</span>. However, <em>B. inermis</em> still holds considerable ecological and potential economic value due to its late senescence and WSS antibiosis properties <span class="citation" data-cites="Otfinowski2006 Rand2024">(Otfinowski et al. 2006, Rand et al. 2024)</span>.</p>
<p>Montana’s golden triangle, an area of central and northern Montana with intense cereal grain production, is prone to drought and burning via wildfire <span class="citation" data-cites="Wilson1923 Adhikari2019">(Wilson 1923, Adhikari et al. 2019)</span>. As both <em>C. cinctus</em> and its host-specific parasitoids are relatively restricted in their annual mobility <span class="citation" data-cites="Weaver2005">(Weaver et al. 2005)</span>, environmental extremes can have broad impacts on both local pest and natural enemy populations. As with many predator-prey interactions, the <em>C. cinctus</em> and parasitoid populations fluctuate, with crashes and spikes experienced in close succession and through ineteraction with drought <span class="citation" data-cites="Holmes1963 Holmes1982">(Holmes et al. 1963, Holmes 1982)</span>. Similar examples of these classical population dynamics patterns can be found in wolves and moose on Isle Royale <span class="citation" data-cites="Peterson1999">(Peterson 1999)</span>, and Coccinellidae and aphids <span class="citation" data-cites="Evans1999">(Evans 1999)</span>, among others.</p>
<p>We examined historical weather data from two field locations (10 sites overall) in central and northern Montana. We used this data to understand how changes in global climate trends may be impacting <em>C. cinctus</em>, <em>B. cephi</em> and <em>B. lissogaster</em> interact with <em>B. inermis</em> populations. In addition we analyzed normalized difference vegetative index (NDVI) at our field sites to understand how <em>B. inermis</em> senescence patterns compare to adjacent cultivated wheat fields.</p>
<p>In this study, we explored the ecological patterns between Montana populations of <em>C. cinctus</em> and its associated braconid parasitoids in relation to <em>B. inermis</em> host sites. Our goal, was 1) to understand the degree to which <em>C. cinctus</em> infested <em>B. inermis</em> stems in relation to neighboring cereal crops, and 2) the way in which braconid parasitoids utilized WSS hosts available within <em>B. inermis</em> stems. To do so, we conducted two separate studies. In our first study, we conducted controlled <em>C. cinctus</em> infestation of <em>B. inermis</em> to understand the relative infestation and cutting rate of <em>C. cinctus</em> within the <em>B. inermis</em> stems in the absence of parasitoids. The second study examined rates of cutting and parasitism in wheat crops and their surroundings at field sites in central and northern Montana.</p>
<p>Using these studies, we addressed three questions, 1) what is the total <em>C. cinctus</em>-caused stem cutting heading into overwinter - and thus the source rate, of the subsequent <em>C. cinctus</em> population in <em>B. inermis</em>? 2) can <em>C. cinctus</em> larvae within <em>B. inermis</em> serve as critical second generation hosts for <em>B. cephi</em> and <em>B. lissogaster</em>? and 3) how do annual <em>C. cinctus</em> and parasitoid populations in <em>B. inermis</em> compare with those in the adjacent cultivated wheat fields?</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Title Page">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Title Page</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./1c_methods.html" class="pagination-link" aria-label="Materials and Methods">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Materials and Methods</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>